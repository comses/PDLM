# Controller Atomic Model
[controller]
in_ports = []
out_ports = ["command"]
time_advance = 10

# Controller State Variables
[controller.state.status]
type = "string"
initial_value = "off"

[controller.state.time_advance]
type = "float"
initial_value = 10

# Controller Internal Transition Function
internal_transition_function = """
if status == 'on':
    status = 'off'
else:
    status = 'on'
ta = 1
"""

# Controller Output Function
output_function = """
send('command', status)
"""

# Light Atomic Model
[light]
in_ports = ["control"]
out_ports = []
time_advance = inf

# Light State Variables
[light.state.status]
type = "string"
initial_value = "off"

# Light External Transition Function
external_transition_function = """
if port_name == 'control':
    status = message
"""

# Coupled Model: Root
[root]
components = [
    { model = "controller", name = "controller"},
    { model = "light", name = "light"}
]

[[root.connections]]
source = "controller.command"
target = "light.control"